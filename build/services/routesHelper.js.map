{"version":3,"file":"routesHelper.js","names":["allowOnly","accessLevel","callback","checkUserRole","req","res","role","user","dataValues","console","log","status","json","msg"],"sources":["../../src/services/routesHelper.js"],"sourcesContent":["const allowOnly = function(accessLevel, callback) {\n    function checkUserRole(req, res) {\n        const { role } = req.user[0].dataValues;\n        console.log(accessLevel)\n        console.log(role)\n        if(!(accessLevel & role)) {\n            res.status(403).json({ msg: 'You do not have access to this'})\n            return;\n        }\n\n        callback(req, res)\n    }\n\n    return checkUserRole;\n}\n\nexport { allowOnly }"],"mappings":"AAAA,MAAMA,SAAS,GAAG,SAAAA,CAASC,WAAW,EAAEC,QAAQ,EAAE;EAC9C,SAASC,aAAaA,CAACC,GAAG,EAAEC,GAAG,EAAE;IAC7B,MAAM;MAAEC;IAAK,CAAC,GAAGF,GAAG,CAACG,IAAI,CAAC,CAAC,CAAC,CAACC,UAAU;IACvCC,OAAO,CAACC,GAAG,CAACT,WAAW,CAAC;IACxBQ,OAAO,CAACC,GAAG,CAACJ,IAAI,CAAC;IACjB,IAAG,EAAEL,WAAW,GAAGK,IAAI,CAAC,EAAE;MACtBD,GAAG,CAACM,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,GAAG,EAAE;MAAgC,CAAC,CAAC;MAC9D;IACJ;IAEAX,QAAQ,CAACE,GAAG,EAAEC,GAAG,CAAC;EACtB;EAEA,OAAOF,aAAa;AACxB,CAAC;AAED,SAASH,SAAS","ignoreList":[]}